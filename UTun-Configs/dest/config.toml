# UTun Destination Configuration
# This runs on the DEST server - receives tunneled traffic and forwards to local services

[dest]
# Listen for tunnel connections from source
listen_ip = "0.0.0.0"
tunnel_port = 5983

# Connection limits
max_connections_per_service = 1000
connection_timeout_ms = 15000
target_connect_timeout_ms = 5000

# Service to expose (port 80 - web server)
[[dest.exposed_services]]
name = "http"
port = 80
target_ip = "127.0.0.1"
target_port = 80
protocol = "tcp"
description = "HTTP web server"

# IP filtering (replace with your SOURCE server IP)
[dest.connection_filter]
allowed_source_ips = ["20.117.185.77/32"]

# mTLS Authentication
[auth]
use_mtls = true
ca_cert_path = "/certs/ca.crt"
server_cert_path = "/certs/server.crt"
server_key_path = "/certs/server.key"
verify_client_cert = true

# Post-Quantum Cryptography Settings
[crypto]
kem_mode = "mlkem768"
key_rotation_interval_seconds = 3600
rehandshake_before_expiry_seconds = 300

# Logging
[logging]
level = "info"
format = "json"
include_timestamp = true

# Metrics
[metrics]
enabled = true
metrics_port = 9091
